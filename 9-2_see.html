<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>소통 상세</title>
<link rel="stylesheet" href="9-2_see.css">
<script>
    window.onload = function() {
        var postId = localStorage.getItem('selectedPostId');
        if (postId !== null) {
            var storedPosts = localStorage.getItem('newPosts');
            if (storedPosts) {
                var posts = JSON.parse(storedPosts);
                displayPostDetail(posts[postId]);
            }
        }
        displayComments(); // 댓글을 로드하는 함수 호출
    };

    function displayPostDetail(post) {
        var contentDiv = document.querySelector('.content');
        contentDiv.innerHTML = `
            <h2>${post.title}</h2>
            <p>작성자: 사용자 이름, 작성일: ${post.date}</p>
            <p>${post.content}</p>
            <textarea id="comment" placeholder="댓글을 입력하세요" rows="4" cols="50"></textarea>
            <button class="create-button" onclick="submitComment()">댓글 전송</button>
            <div id="communication-comments"></div> <!-- 수정된 id -->
            <button class="create-button" onclick="window.location.href='9_commincation.html';">목록으로 돌아가기</button>
        `;
    }

    function displayComments() {
        var storedComments = localStorage.getItem('comments');
        if (storedComments) {
            var comments = JSON.parse(storedComments);
            var commentsDiv = document.getElementById('communication-comments'); // 수정된 id
            commentsDiv.innerHTML = ''; // 기존 댓글 초기화
            comments.forEach(function(comment) {
                var commentElement = document.createElement('p');
                commentElement.textContent = comment;
                commentsDiv.appendChild(commentElement);
            });
        }
    }

    function submitComment() {
        var comment = document.getElementById('comment').value;
        if (comment.trim() === '') {
            alert('댓글을 입력하세요.');
            return;
        }
        
        // 로컬 스토리지에 저장하는 부분
        var storedComments = localStorage.getItem('comments');
        var comments = storedComments ? JSON.parse(storedComments) : [];
        comments.push(comment);
        localStorage.setItem('comments', JSON.stringify(comments));

        alert('댓글이 전송되었습니다.');
        document.getElementById('comment').value = ''; // 댓글 입력창 비우기
        displayComments(); // 댓글 목록 갱신
    }
</script>
</head>
<body>
<div class="container">
    <header>
        <a href="4_main.html">
            <img id="logo" src="logo.png" alt="Logo">
        </a>
        <input id="search-bar" type="text" placeholder="레시피 검색...">
        <div id="user-name">사용자 이름
            <div class="dropdown-icon">&#9660;</div>
        </div>
    </header>
    <nav>
        <a href="5_listADD.html">냉장고</a>
        <a href="8_myrecipes.html">내 레시피</a>
        <a href="7_newrecipe.html">레시피 만들기</a>
        <a href="9_commincation.html">소통</a>
        <a href="10_qna.html">문의 사항</a>
    </nav>
    <div class="content">
        <!-- 내용이 여기에 표시됩니다 -->
    </div> 
</div>
</body>
</html>
